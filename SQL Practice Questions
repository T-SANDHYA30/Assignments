use ass2;
show tables;
desc customers;
desc employees;
desc orders;
desc orderdetails;
desc productlines;
desc products;
desc payments;
desc offices;
select * from payments;
select * from customers;
select * from offices;
select* from orders;
select * from products;
select * from employees;

insert into customers values(34,'sandy','thum','viswa',77777,'muddanur','kkt street','kadapa','ap','1965','india','1165',661);
update customers set creditLimit=creditLimit+creditLimit*0.1;
delete from orders where orderDate<'2005-01-01';
insert into products values('090','pdname','Classic Cars','60','sandy','nice car',2,89,665);
insert into payments values(30,'JM555205','2003-09-20',9000);
delete from offices where city='London';
select productCode from products where productCode not in(select productCode from orderdetails);
DELETE FROM products p WHERE NOT EXISTS (
 select 1 FROM orderdetails od where od.productCode = p.productCode
 );
insert into employees values(8,'hi','world','hehe','sandy@mail','1',1002,'it inspector');
select * from customers where creditLimit>50000;
select * from offices where officeCode='1';
select * from products where 50<buyPrice<100;
select * from employees where reportsTo=1143;
select * from customers where city like 'S%';
select * from orders where status = 'Shipped' and orderDate like '2004%';
select * from payments where paymentDate like '2003%';

/* GROUP BY AND HAVING*/
select customerNumber,count(*) from payments group by customerNumber;
select customerNumber,count(*) from payments group by customerNumber having count(*)>3;
select officeCode,count(*) from employees group by officeCode;
select productLine,avg(buyPrice) from products group by productLine having avg(buyPrice)>100;
select customerNumber,sum(amount) from payments group by customerNumber having sum(amount)>50000;
select productCode,count(*) from products group by productCode;
select status,count(*) from orders group by status;
select reportsTo,count(*) from employees group by reportsTo;

/*ORDER BYCLAUSE*/
SELECT * FROM customers order by creditLimit desc;
select * from orderdetails order by quantityOrdered asc;
select * from payments order by paymentDate desc;
select * from employees order by jobTitle,lastName;
select * from customers order by creditlimit desc limit 5;
select * from products order by productLine asc;
select * from products order by productLine,buyPrice;

/*joins*/
select o.orderNumber, c.customerName from orders as o inner join customers as c on o.customerNumber=c.customerNumber;
 
select p.*,oq.quantityordered from products as p left join orderdetails as oq on p.productCode=oq.productCode;
select customers.customerNumber,customers.customerName from customers left join orders on customers.customerNumber=orders.customerNumber where orders.customerNumber is NULL;
SELECT  o.*, e.employeeNumber,e.jobTitle FROM offices AS o LEFT JOIN employees AS e ON o.officeCode = e.officeCode;
select orderdetails.*, products.productName,products.quantityInStock,products.buyPrice from orderdetails left join products on orderdetails.productCode=products.productCode;


/*bUILT-IN functions (mysql)*/
SELECT now();
select count(*) from customers;
select substr(customerName,1,5) from customers;
select * from orders where datediff(now(), orderDate)<=30;
select DATE_FORMAT(orderDate,'%d-%m-%y') from orders;
select length(customerName) as namelength from customers;
select lower(lastName) from employees;
SELECT orderNumber, SUM(quantityOrdered * priceEach) from orderdetails AS TotalSales GROUP BY orderNumber;
select customerNumber,YEAR(paymentDate) as paymentyear, MONTH(paymentDate) as paymentmonth from payments; 
